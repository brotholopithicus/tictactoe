(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Action=void 0;var _createClass=function(){function e(e,n){for(var a=0;a<n.length;a++){var t=n[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,a,t){return a&&e(n.prototype,a),t&&e(n,t),n}}(),_state=require("./state"),Action=exports.Action=function(){function e(n){_classCallCheck(this,e),this.pos=n,this.minimaxVal=0}return _createClass(e,[{key:"applyTo",value:function(e){var n=new _state.State(e);return n.board[this.pos]=e.turn,"O"===e.turn&&n.aiMovesCount++,n.advanceTurn(),n}}],[{key:"sortAscending",value:function(e,n){return e.minimaxVal<n.minimaxVal?-1:e.minimaxVal>n.minimaxVal?1:0}},{key:"sortDescending",value:function(e,n){return e.minimaxVal>n.minimaxVal?-1:e.minimaxVal<n.minimaxVal?1:0}}]),e}();

},{"./state":6}],2:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AI=void 0;var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_action=require("./action"),_game=require("./game"),AI=exports.AI=function(){function e(t,a){_classCallCheck(this,e),this.intelligence=t,this.game=a}return _createClass(e,[{key:"minimaxValue",value:function(e){var t=this;if(e.isTerminal())return _game.Game.score(e);var a=void 0;a="X"===e.turn?-1e3:1e3;var n=e.emptyCells(),i=n.map(function(t){var a=new _action.Action(t),n=a.applyTo(e);return n});return i.forEach(function(n){var i=t.minimaxValue(n);"X"===e.turn?i>a&&(a=i):i<a&&(a=i)}),a}},{key:"randomMove",value:function(e){var t=this.game.currentState.emptyCells(),a=t[Math.floor(Math.random()*t.length)],n=new _action.Action(a),i=n.applyTo(this.game.currentState);this.game.ui.insertAt(a,e),this.game.advanceState(i)}},{key:"noobMove",value:function(e){var t=this,a=this.game.currentState.emptyCells(),n=a.map(function(e){var a=new _action.Action(e),n=a.applyTo(t.game.currentState);return a.minimaxVal=t.minimaxValue(n),a}),i="X"===e?_action.Action.sortDescending:_action.Action.sortAscending;n.sort(i);var r=void 0;r=Math.random()>=.5?n[0]:n.length>=2?n[1]:n[0];var o=r.applyTo(this.game.currentState);this.game.ui.insertAt(r.pos,e),this.game.advanceState(o)}},{key:"hardMove",value:function(e){var t=this,a=this.game.currentState.emptyCells(),n=a.map(function(e){var a=new _action.Action(e),n=a.applyTo(t.game.currentState);return a.minimaxVal=t.minimaxValue(n),a}),i="X"===e?_action.Action.sortDescending:_action.Action.sortAscending;n.sort(i);var r=void 0;r=Math.random()>=.25?n[0]:n.length>=2?n[1]:n[0];var o=r.applyTo(this.game.currentState);this.game.ui.insertAt(r.pos,e),this.game.advanceState(o)}},{key:"masterMove",value:function(e){var t=this,a=this.game.currentState.emptyCells(),n=a.map(function(e){var a=new _action.Action(e),n=a.applyTo(t.game.currentState);return a.minimaxVal=t.minimaxValue(n),a}),i="X"===e?_action.Action.sortDescending:_action.Action.sortAscending;n.sort(i);var r=n[0],o=r.applyTo(this.game.currentState);this.game.ui.insertAt(r.pos,e),this.game.advanceState(o)}},{key:"notify",value:function(e){switch(this.intelligence){case"easy":this.randomMove(e);break;case"normal":this.noobMove(e);break;case"hard":this.hardMove(e);break;case"impossible":this.masterMove(e)}}}]),e}();

},{"./action":1,"./game":3}],3:[function(require,module,exports){
"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Game=void 0;var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),_component=require("./libs/component"),_state=require("./state"),_ai=require("./ai"),_ui=require("./ui"),Game=exports.Game=function(){function t(e,i){_classCallCheck(this,t),"string"!=typeof e&&(e=e.toString()),["easy","normal","hard","impossible"].includes(e)||(e="easy"),this.aiPlayer=new _ai.AI(e,this),this.currentState=new _state.State,this.currentState.board=["E","E","E","E","E","E","E","E","E"],this.currentState.turn="X",this.status="start",this.playerSymbol=i,this.aiSymbol="X"===i?"O":"X"}return _createClass(t,[{key:"initializeBoard",value:function(){var t=document.createElement("div");t.classList.add("main");for(var e=(0,_component.createComponent)("div",t,{classes:["board"],styles:[{key:"opacity",value:1}]}),i=0;i<9;i++)(0,_component.createComponent)("div",e,{classes:["cell"],data:[{key:"index",value:i}]});(0,_component.createComponent)("div",t,{classes:["turn"]}),(0,_component.createComponent)("button",t,{id:"restart",attributes:[{key:"disabled",value:!0}],text:"Restart"});document.body.appendChild(t)}},{key:"advanceState",value:function(t){this.currentState=t,t.isTerminal()?(this.status="gameover","X-wins"===t.result?this.ui.switchViewTo("won"):"O-wins"===t.result?this.ui.switchViewTo("lost"):this.ui.switchViewTo("draw")):"X"===this.currentState.turn?this.ui.switchViewTo("human"):(this.ui.switchViewTo("robot"),this.aiPlayer.notify("O"))}},{key:"start",value:function(){"start"===this.status&&(this.advanceState(this.currentState),this.status="running")}}],[{key:"score",value:function(t){if("running"!==t.result)return"X-wins"===t.result?10-t.aiMovesCount:"O-wins"===t.result?-10+t.aiMovesCount:0}}]),t}();

},{"./ai":2,"./libs/component":5,"./state":6,"./ui":7}],4:[function(require,module,exports){
"use strict";function symbolTouchHandler(e){e.preventDefault(),symbolClickHandler(e)}function symbolClickHandler(e){symbol="X"===e.target.dataset.symbol?"X":"O",document.body.removeChild(document.querySelector(".chooseSymbol")),document.querySelector(".chooseDifficulty").style.display="";var t=document.querySelectorAll(".difficulties span");t.forEach(function(e){e.addEventListener("click",difficultyClickHandler),e.addEventListener("touchstart",difficultyTouchHandler)})}function difficultyTouchHandler(e){e.preventDefault(),difficultyClickHandler(e)}function difficultyClickHandler(e){difficulty=e.target.dataset.diff,document.body.removeChild(document.querySelector(".chooseDifficulty")),startGame()}function startGame(){var e=document.querySelector(".main"),t=new _game.Game(difficulty,symbol);e||t.initializeBoard();var l=document.querySelectorAll(".cell");t.ui=new _ui.UI(t,l);var r=document.querySelector("#restart");r.addEventListener("click",restartGame),r.addEventListener("touchstart",restartGame),document.querySelector("#restart").disabled=!0,document.querySelectorAll(".cell").forEach(function(e){e.classList.remove("occupied"),e.textContent=""}),t.start()}function restartGame(){startGame(symbol)}var _game=require("./game"),_ui=require("./ui"),difficulty=void 0,symbol=void 0,symbols=document.querySelectorAll(".symbols span");symbols.forEach(function(e){e.addEventListener("click",symbolClickHandler),e.addEventListener("touchstart",symbolTouchHandler)});

},{"./game":3,"./ui":7}],5:[function(require,module,exports){
"use strict";function createComponent(e,t,n){var o=document.createElement(e);return t.appendChild(o),"undefined"!=typeof n.data&&n.data.forEach(function(e){return o.dataset[e.key]=e.value}),"undefined"!=typeof n.id&&(o.id=n.id),"undefined"!=typeof n.classes&&n.classes.forEach(function(e){return o.classList.add(e)}),"undefined"!=typeof n.styles&&n.styles.forEach(function(e){return o.style[e.key]=e.value}),"undefined"!=typeof n.attributes&&n.attributes.forEach(function(e){return o.setAttribute(e.key,e.value)}),"undefined"!=typeof n.text&&(o.textContent=n.text),o}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createComponent=createComponent;

},{}],6:[function(require,module,exports){
"use strict";function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,r){for(var e=0;e<r.length;e++){var s=r[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(r,e,s){return e&&t(r.prototype,e),s&&t(r,s),r}}(),State=exports.State=function(){function t(r){if(_classCallCheck(this,t),this.turn="",this.aiMovesCount=0,this.result="running",this.board=[],r){this.board=new Array(r.board.length);for(var e=0;e<r.board.length;e++)this.board[e]=r.board[e];this.aiMovesCount=r.aiMovesCount,this.result=r.result,this.turn=r.turn}}return _createClass(t,[{key:"advanceTurn",value:function(){this.turn="X"===this.turn?"O":"X"}},{key:"emptyCells",value:function(){for(var t=[],r=0;r<9;r++)"E"===this.board[r]&&t.push(r);return t}},{key:"isTerminal",value:function(){for(var t=0;t<=6;t+=3)if("E"!==this.board[t]&&this.board[t]===this.board[t+1]&&this.board[t+1]===this.board[t+2])return this.result=this.board[t]+"-wins",!0;for(var r=0;r<=2;r++)if("E"!==this.board[r]&&this.board[r]===this.board[r+3]&&this.board[r+3]===this.board[r+6])return this.result=this.board[r]+"-wins",!0;for(var e=0,s=4;e<=2;e+=2,s-=2)if("E"!==this.board[e]&&this.board[e]==this.board[e+s]&&this.board[e+s]===this.board[e+2*s])return this.result=this.board[e]+"-wins",!0;var a=this.emptyCells();return 0===a.length&&(this.result="draw",!0)}}]),t}();

},{}],7:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.UI=void 0;var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_state=require("./state"),UI=exports.UI=function(){function e(t,a){_classCallCheck(this,e),this.game=t,this.cells=a,this.addClickListeners()}return _createClass(e,[{key:"addClickListeners",value:function(){var e=this;this.cells.forEach(function(t){return t.addEventListener("click",e.cellClickHandler.bind(e))}),this.cells.forEach(function(t){return t.addEventListener("touchstart",e.cellTouchHandler.bind(e))})}},{key:"cellTouchHandler",value:function(e){e.preventDefault(),this.cellClickHandler(e)}},{key:"cellClickHandler",value:function(e){if("running"===this.game.status&&"X"===this.game.currentState.turn&&!e.target.classList.contains("occupied")){var t=parseFloat(e.target.dataset.index),a=new _state.State(this.game.currentState);a.board[t]="X",this.insertAt(t,"X"),a.advanceTurn(),this.game.advanceState(a)}}},{key:"switchViewTo",value:function(e){var t=document.querySelector(".turn"),a=document.querySelector(".board"),n=document.querySelector("#restart");switch(a.style.opacity=1,"won"!==e&&"lost"!==e&&"draw"!==e||(a.style.opacity=.2,n.disabled=!1),e){case"human":t.textContent="It's your turn.",t.style.color="#00f0ff";break;case"robot":t.textContent="AI player turn.",t.style.color="#ff53ba";break;case"won":t.textContent="You win! Play again?",t.style.color="blue";break;case"lost":t.textContent="You lost! Play again?",t.style.color="red";break;case"draw":t.textContent="It's a tie! Play again?",t.style.color="white";break;default:t.textContent="Something is broken.",console.log("something is broken")}}},{key:"insertAt",value:function(e,t){var a=document.querySelector('div[data-index="'+e+'"]'),n="X"===t?this.game.playerSymbol:this.game.aiSymbol;a.style.color="X"===t?"#00f0ff":"#ff53ba",a.textContent=n,a.classList.add("occupied")}},{key:"clearBoard",value:function(){this.cells.forEach(function(e){e.textContent="",e.classList.remove("occupied")})}}]),e}();

},{"./state":6}]},{},[4]);
